
# üí¨ Django Real-Time Chat Engine
A professional, high-performance real-time communication engine built using **Django Channels**, **WebSockets**, and **Django ORM**. This project implements an asynchronous backend architecture to handle both public room broadcasting and secure one-to-one private messaging.

---

## üóÑÔ∏è Milestone 8: Production-Ready Database & Security
Transitioned from development-grade SQLite to production-grade PostgreSQL:

- [x] **Database Migration:** Migrated the entire schema to **PostgreSQL** for better concurrency and scalability.
- [x] **Environment Security:** Integrated `django-environ` to manage sensitive data (Secret Keys, DB Credentials) via **.env** files.
- [x] **Advanced Search Logic:** (In Progress) Implementing optimized chat search using PostgreSQL's indexing.
- [x] **Real-time Search:** Implemented AJAX-based keyword searching for instant message retrieval.

## üé§ Milestone 7: Voice Messaging (Latest)
Enhanced the engine with real-time voice communication features:

- [x] **Voice Recording:** Record audio directly via `MediaRecorder API`.
- [x] **WebSocket Streaming:** Instant delivery using `Base64 encoding` over sychronous channels. 
- [x] **Backend Storage:** Auto-decoding and saving as `.wav` files with `UUID` naming.
- [x] **Dynamic UI:** Integrated HTML5 audio players and `Live Recording (üî¥)` indicators.
- [x] **Universal Support:** Fully functional in both `Public Rooms` and `Private DMs`.

## üöÄ Recent Update: Milestone 6 (One-to-One Private Messaging)
The engine has evolved from a public broadcaster to a sophisticated private communication tool:

- [x] **Dynamic Private Room Logic:** Implemented a unique Room-ID generation algorithm using sorted User IDs (e.g., `private_1_2`) to ensure consistent private channels.
- [x] **Isolated Database Models:** Created `PrivateChatRoom` and `PrivateMessage` models to ensure private data is stored separately from public room logs.
- [x] **Hybrid WebSocket Consumer:** Upgraded `ChatConsumer` to intelligently detect and route messages based on room types (Public vs. Private).
- [x] **User Directory Dashboard:** A new UI section in `index.html` that allows users to see all registered members and initiate private chats instantly.
- [x] **Persistence for DMs:** Fully integrated history fetching for private chats, ensuring messages and images remain accessible after reload.

## üõ†Ô∏è Core Features Implementation (Milestone 1 - 5)

- [x] **ASGI Configuration:** Powered by `Daphne` using `ProtocolTypeRouter` for seamless HTTP/WebSocket handling.
- [x] **Dockerized Redis Broker:** Uses `Redis` as the channel layer to manage real-time message brokering.
- [x] **Multimedia Support:** Instant image sharing using Base64 encoding and unique UUID filename generation.
- [x] **Advanced UX Components:**
    - **Typing Indicators:** Real-time "User is typing..." feedback.
    - **Online Presence:** Live tracking of active users in rooms.
    - **Read Receipts:** Double-tick (‚úì‚úì) system indicating message status.
    - **Auto-Hyperlinks:** Automatic URL detection and clickable link conversion.
- [x] **Security:** Full Django Auth integration with restricted access via `@login_required`.

---

## üìÇ Technical Workflow & Architecture


1. **Handshake:** Client initiates WebSocket connection to `/ws/chat/<room_name>/`.
2. **Routing:** `routing.py` maps the connection to `ChatConsumer`.
3. **Database Sync:** Uses `@database_sync_to_async` to perform thread-safe ORM operations within the async consumer.
4. **Broadcast Logic:** Messages are received by the consumer, saved to the database, and then broadcasted to the specific Channel Layer group.
5. **Private Logic:** For private chats, the consumer verifies the `private_` prefix and interacts with `PrivateMessage` models instead of the default `Message` model.
6. **Audio Capture (MediaRecorder API):** Captures raw audio streams from the user's microphone and stores them in small data chunks.
7. **Base64 Encoding:** Upon stopping the recording, the `Blob` object is converted into a Base64-encoded string via `FileReader` to make it compatible with JSON transmission over WebSockets.
8. **Asynchronous File Handling:** - The `ChatConsumer` receives the Base64 payload.
    It decodes the string into binary data using `base64.b64decode`.
    Saves the data as a `.wav` file using Django's `ContentFile`, assigning a unique UUID-based filename to prevent overwriting.
9. **Media URL Broadcasting:** Once saved, the server generates the file's absolute URL and broadcasts it to all group members, triggering the HTML5 <audio> player in their chat interface.

---

## üìÇ Project Structure (Core Files)

- `asgi.py`: Entry point for ASGI servers.
- `consumers.py`: Handles connection logic and real-time data routing.
- `routing.py`: Maps WebSocket URLs to Consumers.
- `models.py`: Defines `Message`, `PrivateChatRoom`, and `PrivateMessage` schemas.
- `views.py`: Manages page rendering and initial chat history retrieval.
- `Multimedia Persistence`: Updated `Message` and `PrivateMessage` models with a `FileField` to store audio recordings in the `/media/audio/` directory.

--- 

## ‚öôÔ∏è How to Setup

1. **clone the repo:**
   ```bash
   git clone [https://github.com/mamun-2025/django-realtime-chat.git]
   cd my_chat_app

2. Run Redis (Docker):
    docker run --name my-chat-redis -p 6379:6379 -d redis

3. Install Dependencies:
    pip install django daphne channels channels-redis Pillow psycopg2 django-environ

4. Setup Environment Variables:
   - Create a `.env` file in the root directory.
   - Add your `SECRET_KEY`, `DB_NAME`, `DB_USER`, `DB_PASSWORD`, `DB_HOST`, and `DB_PORT`.

5. Migrations & Superuser:
    python manage.py makemigrations
    python manage.py migrate
    python manage.py createsuperuser

6. Run Server
   python manage.py runserver

---

## üõ†Ô∏è Upcoming Features
- [x]~~ Frontend integration with JavaScript WebSocket API.~~(Completed)

- [x]~~ Storing chat history in the database.~~(Completed)

- [x]~~ Online/Offline presence indicators.~~(Completed)

- [x]~~ Real-time typing indicators.~~(Completed)

- [x]~~ Image/File sharing capability.~~(Completed)

- [x]~~ Private Messaging (1-to-1).~~(Completed)

- [x]~~ Audio/Voice Message Recording.~~(Completed)

- [x] **Chat Search:** Search specific keywords within message history.

- [ ] **Live Push Notifications:** Browser-level alerts using Service Workers.

- [ ] **Cloud Deployment:** Live hosting on Render/AWS with PostgreSQL.

---

### üì§ GitHub-e upload korar step-by-step process:

Apni coding korben ar update korben‚Äîeta maintain kora khub shohoj. Nicher step-gulo follow korun:

1.  **Repo Initialize kora (Prothom barer jonno):**
    ```bash
    git init
    git add .
    git commit -m "Backend core: ASGI, Routing, and Consumers added"
    # GitHub-e ekta repository khule link-ta niche add korun
    git remote add origin https://github.com/your-username/your-repo-name.git
    git push -u origin main
    ```

2.  **Next Time (Jokhon e README ba Code change korben):**
    Jokhon-e kono file change korben ba README update korben, shudhu ei 3-te command diben:
    ```bash
    git add .
    git commit -m "README: updated project status and features"
    git push
    ```

**Pro-Tip:** Apni jokhon-e `consumers.py`-te kono logic change korben, README-te oi **Current Implementation**-er niche ekta line add kore diben.


















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































